name = "r2"
main = "worker/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Smart Placement disabled for SPA - UI responsiveness priority
placement = { mode = "off" }

[build]
command = "npm run build"
cwd = "."

[assets]
directory = "dist"
binding = "ASSETS"

[[r2_buckets]]
binding = "R2"
bucket_name = "r2-bucket"

[[d1_databases]]
binding = "DB"
database_name = "r2manager"
database_id = "7c4e1036-b1ee-4aaa-b0b2-20ca3fe6e3d9"

# KV Storage for bucket listing cache
[[kv_namespaces]]
binding = "CACHE_KV"
id = "152e6a2775804979b19c3cc22d81a28d"
preview_id = "23e056b1ee1d4b548bcd3d51869109f5"

[observability.logs]
enabled = true

[[routes]]
pattern = "r2.adamic.tech"
custom_domain = true
zone_name = "adamic.tech"